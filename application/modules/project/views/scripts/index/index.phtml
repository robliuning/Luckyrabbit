 <?php
 	$this->headTitle('- 工程管理 - 工程信息');
 	$this->headScript()->prependFile('/js/projectjs/p_project.js');
 ?>
	<div id="contentWrapper">
	<div id="p_breadcrumb"></div>
	<div id="p_stage_sidebar">
	<?php
		echo $this->placeholder('sidebar');
	?>
		<div id="p_content">
		<h1>工程管理 - 工程信息 - 总览</h1>
		<div class="p_msg">
			<h3></h3>
			<p class="errorMsg"><?php
				if($this->errorMsg != null)
				{
				echo $this->errorMsg;
			 		}?>
			 		</p>
		</div>
			<div class="overall_tool">
				<div class="button_group">
					<div id="searchBox">
						<form method="post" action="<?php echo $this->url()?>">
							<div>
								<select name="condition" class="tbMediumer stStyle">
									<option value="projectName">工程名称</option>
									<option value="structype">结构类型</option>
									<option value="name">负责人</option>
								</select>
							</div>
							<div><input class="tbMedium tbText" name="key" type="text" /></div>
							<div><input class= "btSearch" type="submit" value=""></input></div>
						</form>
					</div>
					<div><a href="<?php echo $this->url(array('controller'=>'index','action'=>'add'))?>"><img src="/images/icons/functions/new.png"/><p>新建</p></a></div>
					<div><a href="#msgBox" class="lightbox" id="btDelete"><img src="/images/icons/functions/delete.png"/><p>删除</p></a></div>
					<div><a href="<?php echo $this->url(); ?>"><img src="/images/icons/functions/refresh.png"/><p>显示全部</p></a></div>
					<div><a href="#"><img src="/images/icons/functions/export.png"/><p>导出</p></a></div>
					<div><a href="#"><img src="/images/icons/functions/print.png"/><p>打印</p></a></div>
				</div><!-- end of button group -->
			</div><!-- end of overall tool -->
			<div class="overall_content">
				<table>
					<colgroup>
						<col style="width:3%"></col>
						<col style="width:2%"></col>
						<col style="width:12%"></col>
						<col style="width:8%"></col>
						<col style="width:10%"></col>
						<col style="width:15%"></col>
						<col style="width:20%"></col>
						<col style="width:20%"></col>
						<col style="width:5%"></col>
						<col style="width:5%"></col>
					</colgroup>
					<thead>
						<th>#</th>
						<th><input id="modelName" type="text" class="hide" value="<?php echo $this->modelName ?>"></th>
						<th>工程名称</th>
						<th>工程状态</th>
						<th>结构类型</th>
						<th>工程总负责人</th>
						<th>当前进度阶段</th>
						<th>作业总人数</th>
						<th><input id="module" type="text" class="hide" value="<?php echo $this->module ?>"></th>
						<th><input id="controller" type="text" class="hide" value="<?php echo $this->controller ?>"></th>
					</thead>
					<tr>
						<td><input type="checkbox" id="cb_sa"></td>
						<td colspan="2">全选/取消</td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
					</tr>
					<?php $counter = 1;?>
					<?php foreach($this->arrayProjects as $project):?>
					<?php $projectId = $this->escape($project->getProjectId());?>
					<tr>
						<td><input type="checkbox" name="cbEmp" value="<?php echo $projectId ?>"></td>
						<td><?php
							echo $counter;
							$counter++;
						?></td>
						<td><a href="<?php echo $this->url(array('controller'=>'index','action'=>'display','id'=>$projectId))?>"><?php echo $this->escape($project->getName()) ?></a></td>
						<td><?php
							$status = $this->escape($project->getStatus());
							$stDis = "";
							if($status == 0)
							{
								$stDis = "未开工";
								}
								elseif($status ==1)
								{
									$stDis = "建设中";
									}
									else
									{
										$stDis = "已竣工";
										}
							echo $stDis;

						?></td>
						<td><?php echo $this->escape($project->getStructype()) ?></td>
						<td>
						<?php
							$cId = $this->escape($project->getCId());
							$display = "";
							if($cId == 0)
							{
								$display = $this->escape($project->getCName());
								}
								else
								{
									$display = "<a class='lightbox' href='/employee/index/ajaxdisplay/id/".$cId."')>".$this->escape($project->getCName())."</a>";
									}
								echo $display;
						?>
						</td>
						<td>
							<?php
								if($this->escape($project->getStage()) == 0)
								{
									echo "未设置";
									}
									else
									{
										echo $this->escape($project->getStage());
									}
								?></td>
						<td><?php echo $this->escape($project->getStaffNo())?></td>
						<td><a href="<?php echo $this->url(array('controller'=>'index','action'=>'edit','id'=>$projectId))?>">修改</a></td>
						<td><a href="<?php echo $this->url(array('controller'=>'index','action'=>'display','id'=>$projectId))?>">详情</a></td>
					</tr>
					<?php endforeach ?>
				</table>
				<div id="msgBox"></div>
			</div><!-- end of overall content -->
		</div><!-- end of p_content -->
	</div><!-- end of page stage -->
	</div><!-- end of contentWrapper -->
